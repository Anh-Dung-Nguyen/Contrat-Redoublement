ligne_unique_totale_s3[[i]] <- creer_ligne_unique_s3(dfs3)
ligne_unique_totale_s4[[i]] <- creer_ligne_unique_s4(dfs4)
}
ligne_unique_totale_s3 <- bind_rows(ligne_unique_totale_s3)
ligne_unique_totale_s4 <- bind_rows(ligne_unique_totale_s4)
write_data_to_sheet("/home/nguyen-anh-dung/jury.xlsx", "S3", ligne_unique_totale_s3)
write_data_to_sheet("/home/nguyen-anh-dung/jury.xlsx", "S4", ligne_unique_totale_s4)
}
main()
source("Code/cste/Constantes_MCC.R")
#source("Code/generation_notes/compensation.R")
source("Code/generation_notes/generer_notes_automatique.R")
source("Code/generation_notes/creer_ligne_unique.R")
source("Code/generation_notes/write_data_to_sheet.R")
library(dplyr)
source("Code/cste/Constantes_MCC.R")
#source("Code/generation_notes/compensation.R")
source("Code/generation_notes/generer_notes_automatique.R")
source("Code/generation_notes/creer_ligne_unique.R")
source("Code/generation_notes/write_data_to_sheet.R")
library(dplyr)
main <- function() {
ligne_unique_totale_s3 <- list()
ligne_unique_totale_s4 <- list()
for (i in 1:25){
resultat_FONDA_S3 <- generer_notes_automatique(lesUE[1], lesEC_FONDAS3, lesNotesEC_FONDAS3, poids_FONDA_S3, lesECTSFONDAS3)
resultat_FONDA_S4 <- generer_notes_automatique(lesUE[1], lesEC_FONDAS4, lesNotesEC_FONDAS4, poids_FONDA_S4, lesECTSFONDAS4)
resultat_EXP_S3 <- generer_notes_automatique(lesUE[2], lesEC_EXPS3, lesNotesEC_EXPS3, poids_EXP_S3, lesECTSEXPS3)
resultat_EXP_S4 <- generer_notes_automatique(lesUE[2], lesEC_EXPS4, lesNotesEC_EXPS4, poids_EXP_S4, lesECTSEXPS4)
resultat_ORT_S3 <- generer_notes_automatique(lesUE[3], lesEC_ORTS3, lesNotesEC_ORTS3, poids_ORT_S3, lesECTSORTS3)
resultat_ORT_S4 <- generer_notes_automatique(lesUE[3], lesEC_ORTS4, lesNotesEC_ORTS4, poids_ORT_S4, lesECTSORTS4)
resultat_HUMA_S3 <- generer_notes_automatique(lesUE[4], lesEC_HUMA_S3, lesNotesEC_HUMA, poids_HUMA_S3, lesECTSHUMAS3)
resultat_HUMA_S4 <- generer_notes_automatique(lesUE[4], lesEC_HUMA_S4, lesNotesEC_HUMA, poids_HUMA_S4, lesECTSHUMAS4)
dfs3 <- bind_rows(resultat_FONDA_S3, resultat_EXP_S3, resultat_ORT_S3, resultat_HUMA_S3)
#dfs3 <- compensation_intra_UE(dfs3)
#dfs3 <- compensation_inter_UE(dfs3, ue_scientifique = c(lesUE[1], lesUE[2]))
dfs4 <- bind_rows(resultat_FONDA_S4, resultat_EXP_S4, resultat_ORT_S4, resultat_HUMA_S4)
#dfs4 <- compensation_intra_UE(dfs4)
#dfs4 <- compensation_inter_UE(dfs4, ue_scientifique = c(lesUE[1], lesUE[2]))
LesUE <- bind_rows(dfs3, dfs4)
ligne_unique_totale_s3[[i]] <- creer_ligne_unique_s3(dfs3)
ligne_unique_totale_s4[[i]] <- creer_ligne_unique_s4(dfs4)
}
ligne_unique_totale_s3 <- bind_rows(ligne_unique_totale_s3)
ligne_unique_totale_s4 <- bind_rows(ligne_unique_totale_s4)
write_data_to_sheet("/home/nguyen-anh-dung/jury.xlsx", "S3", ligne_unique_totale_s3)
write_data_to_sheet("/home/nguyen-anh-dung/jury.xlsx", "S4", ligne_unique_totale_s4)
}
main()
source("Code/cste/Constantes_MCC.R")
source("Code/generation_notes/compensation.R")
source("Code/generation_notes/generer_notes_automatique.R")
source("Code/generation_notes/creer_ligne_unique.R")
source("Code/generation_notes/write_data_to_sheet.R")
library(dplyr)
source("Code/cste/Constantes_MCC.R")
source("Code/generation_notes/compensation.R")
source("Code/generation_notes/generer_notes_automatique.R")
source("Code/generation_notes/creer_ligne_unique.R")
source("Code/generation_notes/write_data_to_sheet.R")
library(dplyr)
main <- function() {
ligne_unique_totale_s3 <- list()
ligne_unique_totale_s4 <- list()
for (i in 1:25){
resultat_FONDA_S3 <- generer_notes_automatique(lesUE[1], lesEC_FONDAS3, lesNotesEC_FONDAS3, poids_FONDA_S3, lesECTSFONDAS3)
resultat_FONDA_S4 <- generer_notes_automatique(lesUE[1], lesEC_FONDAS4, lesNotesEC_FONDAS4, poids_FONDA_S4, lesECTSFONDAS4)
resultat_EXP_S3 <- generer_notes_automatique(lesUE[2], lesEC_EXPS3, lesNotesEC_EXPS3, poids_EXP_S3, lesECTSEXPS3)
resultat_EXP_S4 <- generer_notes_automatique(lesUE[2], lesEC_EXPS4, lesNotesEC_EXPS4, poids_EXP_S4, lesECTSEXPS4)
resultat_ORT_S3 <- generer_notes_automatique(lesUE[3], lesEC_ORTS3, lesNotesEC_ORTS3, poids_ORT_S3, lesECTSORTS3)
resultat_ORT_S4 <- generer_notes_automatique(lesUE[3], lesEC_ORTS4, lesNotesEC_ORTS4, poids_ORT_S4, lesECTSORTS4)
resultat_HUMA_S3 <- generer_notes_automatique(lesUE[4], lesEC_HUMA_S3, lesNotesEC_HUMA, poids_HUMA_S3, lesECTSHUMAS3)
resultat_HUMA_S4 <- generer_notes_automatique(lesUE[4], lesEC_HUMA_S4, lesNotesEC_HUMA, poids_HUMA_S4, lesECTSHUMAS4)
dfs3 <- bind_rows(resultat_FONDA_S3, resultat_EXP_S3, resultat_ORT_S3, resultat_HUMA_S3)
dfs3 <- compensation_intra_UE(dfs3)
dfs3 <- compensation_inter_UE(dfs3, ue_scientifique = c(lesUE[1], lesUE[2]))
dfs4 <- bind_rows(resultat_FONDA_S4, resultat_EXP_S4, resultat_ORT_S4, resultat_HUMA_S4)
dfs4 <- compensation_intra_UE(dfs4)
dfs4 <- compensation_inter_UE(dfs4, ue_scientifique = c(lesUE[1], lesUE[2]))
LesUE <- bind_rows(dfs3, dfs4)
ligne_unique_totale_s3[[i]] <- creer_ligne_unique_s3(dfs3)
ligne_unique_totale_s4[[i]] <- creer_ligne_unique_s4(dfs4)
}
ligne_unique_totale_s3 <- bind_rows(ligne_unique_totale_s3)
ligne_unique_totale_s4 <- bind_rows(ligne_unique_totale_s4)
write_data_to_sheet("/home/nguyen-anh-dung/jury.xlsx", "S3", ligne_unique_totale_s3)
write_data_to_sheet("/home/nguyen-anh-dung/jury.xlsx", "S4", ligne_unique_totale_s4)
}
main()
View(LesUE)
View(LesUE)
source("Code/cste/Constantes_MCC.R")
source("Code/generation_notes/compensation.R")
source("Code/generation_notes/generer_notes_automatique.R")
source("Code/generation_notes/creer_ligne_unique.R")
source("Code/generation_notes/write_data_to_sheet.R")
source("Code/cste/jury.xlsx")
source("Code/cste/Constantes_MCC.R")
source("Code/generation_notes/compensation.R")
source("Code/generation_notes/generer_notes_automatique.R")
source("Code/generation_notes/creer_ligne_unique.R")
source("Code/generation_notes/write_data_to_sheet.R")
source("Code/cste/jury.xlsx")
source("Code/cste/Constantes_MCC.R")
source("Code/generation_notes/compensation.R")
source("Code/generation_notes/generer_notes_automatique.R")
source("Code/generation_notes/creer_ligne_unique.R")
source("Code/generation_notes/write_data_to_sheet.R")
#source("Code/cste/jury.xlsx")
library(dplyr)
main <- function() {
ligne_unique_totale_s3 <- list()
ligne_unique_totale_s4 <- list()
for (i in 1:25){
resultat_FONDA_S3 <- generer_notes_automatique(lesUE[1], lesEC_FONDAS3, lesNotesEC_FONDAS3, poids_FONDA_S3, lesECTSFONDAS3)
resultat_FONDA_S4 <- generer_notes_automatique(lesUE[1], lesEC_FONDAS4, lesNotesEC_FONDAS4, poids_FONDA_S4, lesECTSFONDAS4)
resultat_EXP_S3 <- generer_notes_automatique(lesUE[2], lesEC_EXPS3, lesNotesEC_EXPS3, poids_EXP_S3, lesECTSEXPS3)
resultat_EXP_S4 <- generer_notes_automatique(lesUE[2], lesEC_EXPS4, lesNotesEC_EXPS4, poids_EXP_S4, lesECTSEXPS4)
resultat_ORT_S3 <- generer_notes_automatique(lesUE[3], lesEC_ORTS3, lesNotesEC_ORTS3, poids_ORT_S3, lesECTSORTS3)
resultat_ORT_S4 <- generer_notes_automatique(lesUE[3], lesEC_ORTS4, lesNotesEC_ORTS4, poids_ORT_S4, lesECTSORTS4)
resultat_HUMA_S3 <- generer_notes_automatique(lesUE[4], lesEC_HUMA_S3, lesNotesEC_HUMA, poids_HUMA_S3, lesECTSHUMAS3)
resultat_HUMA_S4 <- generer_notes_automatique(lesUE[4], lesEC_HUMA_S4, lesNotesEC_HUMA, poids_HUMA_S4, lesECTSHUMAS4)
dfs3 <- bind_rows(resultat_FONDA_S3, resultat_EXP_S3, resultat_ORT_S3, resultat_HUMA_S3)
print(dfs3)
dfs3 <- compensation_intra_UE(dfs3)
dfs3 <- compensation_inter_UE(dfs3, ue_scientifique = c(lesUE[1], lesUE[2]))
dfs4 <- bind_rows(resultat_FONDA_S4, resultat_EXP_S4, resultat_ORT_S4, resultat_HUMA_S4)
dfs4 <- compensation_intra_UE(dfs4)
dfs4 <- compensation_inter_UE(dfs4, ue_scientifique = c(lesUE[1], lesUE[2]))
LesUE <- bind_rows(dfs3, dfs4)
ligne_unique_totale_s3[[i]] <- creer_ligne_unique_s3(dfs3)
ligne_unique_totale_s4[[i]] <- creer_ligne_unique_s4(dfs4)
}
ligne_unique_totale_s3 <- bind_rows(ligne_unique_totale_s3)
ligne_unique_totale_s4 <- bind_rows(ligne_unique_totale_s4)
write_data_to_sheet("/home/nguyen-anh-dung/jury.xlsx", "S3", ligne_unique_totale_s3)
write_data_to_sheet("/home/nguyen-anh-dung/jury.xlsx", "S4", ligne_unique_totale_s4)
}
main()
source("Code/cste/Constantes_MCC.R")
source("Code/generation_notes/compensation.R")
source("Code/generation_notes/generer_notes_automatique.R")
source("Code/generation_notes/creer_ligne_unique.R")
source("Code/generation_notes/write_data_to_sheet.R")
#source("Code/cste/jury.xlsx")
library(dplyr)
main <- function() {
ligne_unique_totale_s3 <- list()
ligne_unique_totale_s4 <- list()
for (i in 1:25){
resultat_FONDA_S3 <- generer_notes_automatique(lesUE[1], lesEC_FONDAS3, lesNotesEC_FONDAS3, poids_FONDA_S3, lesECTSFONDAS3)
resultat_FONDA_S4 <- generer_notes_automatique(lesUE[1], lesEC_FONDAS4, lesNotesEC_FONDAS4, poids_FONDA_S4, lesECTSFONDAS4)
resultat_EXP_S3 <- generer_notes_automatique(lesUE[2], lesEC_EXPS3, lesNotesEC_EXPS3, poids_EXP_S3, lesECTSEXPS3)
resultat_EXP_S4 <- generer_notes_automatique(lesUE[2], lesEC_EXPS4, lesNotesEC_EXPS4, poids_EXP_S4, lesECTSEXPS4)
resultat_ORT_S3 <- generer_notes_automatique(lesUE[3], lesEC_ORTS3, lesNotesEC_ORTS3, poids_ORT_S3, lesECTSORTS3)
resultat_ORT_S4 <- generer_notes_automatique(lesUE[3], lesEC_ORTS4, lesNotesEC_ORTS4, poids_ORT_S4, lesECTSORTS4)
resultat_HUMA_S3 <- generer_notes_automatique(lesUE[4], lesEC_HUMA_S3, lesNotesEC_HUMA, poids_HUMA_S3, lesECTSHUMAS3)
resultat_HUMA_S4 <- generer_notes_automatique(lesUE[4], lesEC_HUMA_S4, lesNotesEC_HUMA, poids_HUMA_S4, lesECTSHUMAS4)
dfs3 <- bind_rows(resultat_FONDA_S3, resultat_EXP_S3, resultat_ORT_S3, resultat_HUMA_S3)
print(dfs3)
dfs3 <- compensation_intra_UE(dfs3)
dfs3 <- compensation_inter_UE(dfs3, ue_scientifique = c(lesUE[1], lesUE[2]))
dfs4 <- bind_rows(resultat_FONDA_S4, resultat_EXP_S4, resultat_ORT_S4, resultat_HUMA_S4)
dfs4 <- compensation_intra_UE(dfs4)
dfs4 <- compensation_inter_UE(dfs4, ue_scientifique = c(lesUE[1], lesUE[2]))
LesUE <- bind_rows(dfs3, dfs4)
ligne_unique_totale_s3[[i]] <- creer_ligne_unique_s3(dfs3)
ligne_unique_totale_s4[[i]] <- creer_ligne_unique_s4(dfs4)
}
ligne_unique_totale_s3 <- bind_rows(ligne_unique_totale_s3)
ligne_unique_totale_s4 <- bind_rows(ligne_unique_totale_s4)
write_data_to_sheet("/home/nguyen-anh-dung/jury.xlsx", "S3", ligne_unique_totale_s3)
write_data_to_sheet("/home/nguyen-anh-dung/jury.xlsx", "S4", ligne_unique_totale_s4)
}
main()
source("Code/cste/Constantes_MCC.R")
source("Code/generation_notes/compensation.R")
source("Code/generation_notes/generer_notes_automatique.R")
source("Code/generation_notes/creer_ligne_unique.R")
source("Code/generation_notes/write_data_to_sheet.R")
#source("Code/cste/jury.xlsx")
library(dplyr)
source("Code/cste/Constantes_MCC.R")
source("Code/generation_notes/compensation.R")
source("Code/generation_notes/generer_notes_automatique.R")
source("Code/generation_notes/creer_ligne_unique.R")
source("Code/generation_notes/write_data_to_sheet.R")
#source("Code/cste/jury.xlsx")
library(dplyr)
main <- function() {
ligne_unique_totale_s3 <- list()
ligne_unique_totale_s4 <- list()
for (i in 1:25){
resultat_FONDA_S3 <- generer_notes_automatique(lesUE[1], lesEC_FONDAS3, lesNotesEC_FONDAS3, poids_FONDA_S3, lesECTSFONDAS3)
resultat_FONDA_S4 <- generer_notes_automatique(lesUE[1], lesEC_FONDAS4, lesNotesEC_FONDAS4, poids_FONDA_S4, lesECTSFONDAS4)
resultat_EXP_S3 <- generer_notes_automatique(lesUE[2], lesEC_EXPS3, lesNotesEC_EXPS3, poids_EXP_S3, lesECTSEXPS3)
resultat_EXP_S4 <- generer_notes_automatique(lesUE[2], lesEC_EXPS4, lesNotesEC_EXPS4, poids_EXP_S4, lesECTSEXPS4)
resultat_ORT_S3 <- generer_notes_automatique(lesUE[3], lesEC_ORTS3, lesNotesEC_ORTS3, poids_ORT_S3, lesECTSORTS3)
resultat_ORT_S4 <- generer_notes_automatique(lesUE[3], lesEC_ORTS4, lesNotesEC_ORTS4, poids_ORT_S4, lesECTSORTS4)
resultat_HUMA_S3 <- generer_notes_automatique(lesUE[4], lesEC_HUMA_S3, lesNotesEC_HUMA, poids_HUMA_S3, lesECTSHUMAS3)
resultat_HUMA_S4 <- generer_notes_automatique(lesUE[4], lesEC_HUMA_S4, lesNotesEC_HUMA, poids_HUMA_S4, lesECTSHUMAS4)
dfs3 <- bind_rows(resultat_FONDA_S3, resultat_EXP_S3, resultat_ORT_S3, resultat_HUMA_S3)
print(dfs3)
dfs3 <- compensation_intra_UE(dfs3)
dfs3 <- compensation_inter_UE(dfs3, ue_scientifique = c(lesUE[1], lesUE[2]))
dfs4 <- bind_rows(resultat_FONDA_S4, resultat_EXP_S4, resultat_ORT_S4, resultat_HUMA_S4)
dfs4 <- compensation_intra_UE(dfs4)
dfs4 <- compensation_inter_UE(dfs4, ue_scientifique = c(lesUE[1], lesUE[2]))
LesUE <- bind_rows(dfs3, dfs4)
ligne_unique_totale_s3[[i]] <- creer_ligne_unique_s3(dfs3)
ligne_unique_totale_s4[[i]] <- creer_ligne_unique_s4(dfs4)
}
ligne_unique_totale_s3 <- bind_rows(ligne_unique_totale_s3)
ligne_unique_totale_s4 <- bind_rows(ligne_unique_totale_s4)
write_data_to_sheet("/home/nguyen-anh-dung/jury.xlsx", "S3", ligne_unique_totale_s3)
write_data_to_sheet("/home/nguyen-anh-dung/jury.xlsx", "S4", ligne_unique_totale_s4)
}
main()
source("Code/cste/Constantes_MCC.R")
source("Code/generation_notes/compensation.R")
source("Code/generation_notes/generer_notes_automatique.R")
source("Code/generation_notes/creer_ligne_unique.R")
source("Code/generation_notes/write_data_to_sheet.R")
library(dplyr)
main <- function() {
ligne_unique_totale_s3 <- list()
ligne_unique_totale_s4 <- list()
for (i in 1:25){
resultat_FONDA_S3 <- generer_notes_automatique(lesUE[1], lesEC_FONDAS3, lesNotesEC_FONDAS3, poids_FONDA_S3, lesECTSFONDAS3)
resultat_FONDA_S4 <- generer_notes_automatique(lesUE[1], lesEC_FONDAS4, lesNotesEC_FONDAS4, poids_FONDA_S4, lesECTSFONDAS4)
resultat_EXP_S3 <- generer_notes_automatique(lesUE[2], lesEC_EXPS3, lesNotesEC_EXPS3, poids_EXP_S3, lesECTSEXPS3)
resultat_EXP_S4 <- generer_notes_automatique(lesUE[2], lesEC_EXPS4, lesNotesEC_EXPS4, poids_EXP_S4, lesECTSEXPS4)
resultat_ORT_S3 <- generer_notes_automatique(lesUE[3], lesEC_ORTS3, lesNotesEC_ORTS3, poids_ORT_S3, lesECTSORTS3)
resultat_ORT_S4 <- generer_notes_automatique(lesUE[3], lesEC_ORTS4, lesNotesEC_ORTS4, poids_ORT_S4, lesECTSORTS4)
resultat_HUMA_S3 <- generer_notes_automatique(lesUE[4], lesEC_HUMA_S3, lesNotesEC_HUMA, poids_HUMA_S3, lesECTSHUMAS3)
resultat_HUMA_S4 <- generer_notes_automatique(lesUE[4], lesEC_HUMA_S4, lesNotesEC_HUMA, poids_HUMA_S4, lesECTSHUMAS4)
dfs3 <- bind_rows(resultat_FONDA_S3, resultat_EXP_S3, resultat_ORT_S3, resultat_HUMA_S3)
print(dfs3)
dfs3 <- compensation_intra_UE(dfs3)
dfs3 <- compensation_inter_UE(dfs3, ue_scientifique = c(lesUE[1], lesUE[2]))
dfs4 <- bind_rows(resultat_FONDA_S4, resultat_EXP_S4, resultat_ORT_S4, resultat_HUMA_S4)
dfs4 <- compensation_intra_UE(dfs4)
dfs4 <- compensation_inter_UE(dfs4, ue_scientifique = c(lesUE[1], lesUE[2]))
LesUE <- bind_rows(dfs3, dfs4)
ligne_unique_totale_s3[[i]] <- creer_ligne_unique_s3(dfs3)
ligne_unique_totale_s4[[i]] <- creer_ligne_unique_s4(dfs4)
}
ligne_unique_totale_s3 <- bind_rows(ligne_unique_totale_s3)
ligne_unique_totale_s4 <- bind_rows(ligne_unique_totale_s4)
write_data_to_sheet("/home/nguyen-anh-dung/jury.xlsx", "S3", ligne_unique_totale_s3)
write_data_to_sheet("/home/nguyen-anh-dung/jury.xlsx", "S4", ligne_unique_totale_s4)
}
main()
source("Code/cste/Constantes_MCC.R")
source("Code/cste/Constantes_MCC.R")
source("Code/cste/Constantes_MCC.R")
source("Code/cste/Constantes_MCC.R")
source("Code/generation_notes/compensation.R")
source("Code/generation_notes/generer_notes_automatique.R")
source("Code/generation_notes/creer_ligne_unique.R")
source("Code/generation_notes/write_data_to_sheet.R")
library(dplyr)
main <- function() {
ligne_unique_totale_s3 <- list()
ligne_unique_totale_s4 <- list()
for (i in 1:25){
resultat_FONDA_S3 <- generer_notes_automatique(lesUE[1], lesEC_FONDAS3, lesNotesEC_FONDAS3, poids_FONDA_S3, lesECTSFONDAS3)
resultat_FONDA_S4 <- generer_notes_automatique(lesUE[1], lesEC_FONDAS4, lesNotesEC_FONDAS4, poids_FONDA_S4, lesECTSFONDAS4)
resultat_EXP_S3 <- generer_notes_automatique(lesUE[2], lesEC_EXPS3, lesNotesEC_EXPS3, poids_EXP_S3, lesECTSEXPS3)
resultat_EXP_S4 <- generer_notes_automatique(lesUE[2], lesEC_EXPS4, lesNotesEC_EXPS4, poids_EXP_S4, lesECTSEXPS4)
resultat_ORT_S3 <- generer_notes_automatique(lesUE[3], lesEC_ORTS3, lesNotesEC_ORTS3, poids_ORT_S3, lesECTSORTS3)
resultat_ORT_S4 <- generer_notes_automatique(lesUE[3], lesEC_ORTS4, lesNotesEC_ORTS4, poids_ORT_S4, lesECTSORTS4)
resultat_HUMA_S3 <- generer_notes_automatique(lesUE[4], lesEC_HUMA_S3, lesNotesEC_HUMA, poids_HUMA_S3, lesECTSHUMAS3)
resultat_HUMA_S4 <- generer_notes_automatique(lesUE[4], lesEC_HUMA_S4, lesNotesEC_HUMA, poids_HUMA_S4, lesECTSHUMAS4)
resultat_STAG_S3 <- generer_notes_automatique(lesUE[5], lesEC_Stage, lesNotesEC_Stage, poids_STAG_S3, lesECTSStage)
dfs3 <- bind_rows(resultat_FONDA_S3, resultat_EXP_S3, resultat_ORT_S3, resultat_HUMA_S3)
dfs3 <- compensation_intra_UE(dfs3, UE = c(lesUE[1], lesUE[2], lesUE[3], lesUE[4], lesUE[1]))
dfs3 <- compensation_inter_UE(dfs3, ue_scientifique = c(lesUE[1], lesUE[2]))
dfs4 <- bind_rows(resultat_FONDA_S4, resultat_EXP_S4, resultat_ORT_S4, resultat_HUMA_S4)
dfs4 <- compensation_intra_UE(dfs4)
dfs4 <- compensation_inter_UE(dfs4, ue_scientifique = c(lesUE[1], lesUE[2]))
LesUE <- bind_rows(dfs3, dfs4)
ligne_unique_totale_s3[[i]] <- creer_ligne_unique_s3(dfs3)
ligne_unique_totale_s4[[i]] <- creer_ligne_unique_s4(dfs4)
}
ligne_unique_totale_s3 <- bind_rows(ligne_unique_totale_s3)
ligne_unique_totale_s4 <- bind_rows(ligne_unique_totale_s4)
write_data_to_sheet("/home/nguyen-anh-dung/jury.xlsx", "S3", ligne_unique_totale_s3)
write_data_to_sheet("/home/nguyen-anh-dung/jury.xlsx", "S4", ligne_unique_totale_s4)
}
main()
View(df_temp)
View(df_temp)
source("Code/cste/Constantes_MCC.R")
source("Code/generation_notes/compensation.R")
source("Code/generation_notes/generer_notes_automatique.R")
source("Code/generation_notes/creer_ligne_unique.R")
source("Code/generation_notes/write_data_to_sheet.R")
library(dplyr)
main <- function() {
ligne_unique_totale_s3 <- list()
ligne_unique_totale_s4 <- list()
for (i in 1:25){
resultat_FONDA_S3 <- generer_notes_automatique(lesUE[1], lesEC_FONDAS3, lesNotesEC_FONDAS3, poids_FONDA_S3, lesECTSFONDAS3)
resultat_FONDA_S4 <- generer_notes_automatique(lesUE[1], lesEC_FONDAS4, lesNotesEC_FONDAS4, poids_FONDA_S4, lesECTSFONDAS4)
resultat_EXP_S3 <- generer_notes_automatique(lesUE[2], lesEC_EXPS3, lesNotesEC_EXPS3, poids_EXP_S3, lesECTSEXPS3)
resultat_EXP_S4 <- generer_notes_automatique(lesUE[2], lesEC_EXPS4, lesNotesEC_EXPS4, poids_EXP_S4, lesECTSEXPS4)
resultat_ORT_S3 <- generer_notes_automatique(lesUE[3], lesEC_ORTS3, lesNotesEC_ORTS3, poids_ORT_S3, lesECTSORTS3)
resultat_ORT_S4 <- generer_notes_automatique(lesUE[3], lesEC_ORTS4, lesNotesEC_ORTS4, poids_ORT_S4, lesECTSORTS4)
resultat_HUMA_S3 <- generer_notes_automatique(lesUE[4], lesEC_HUMA_S3, lesNotesEC_HUMA, poids_HUMA_S3, lesECTSHUMAS3)
resultat_HUMA_S4 <- generer_notes_automatique(lesUE[4], lesEC_HUMA_S4, lesNotesEC_HUMA, poids_HUMA_S4, lesECTSHUMAS4)
resultat_STAG_S3 <- generer_notes_automatique(lesUE[5], lesEC_Stage, lesNotesEC_Stage, poids_STAG_S3, lesECTSStage)
dfs3 <- bind_rows(resultat_FONDA_S3, resultat_EXP_S3, resultat_ORT_S3, resultat_HUMA_S3)
dfs3 <- compensation_intra_UE(dfs3, UE = c(lesUE[1], lesUE[2], lesUE[3], lesUE[4], lesUE[1]))
dfs3 <- compensation_inter_UE(dfs3, ue_scientifique = c(lesUE[1], lesUE[2]))
dfs4 <- bind_rows(resultat_FONDA_S4, resultat_EXP_S4, resultat_ORT_S4, resultat_HUMA_S4)
dfs4 <- compensation_intra_UE(dfs4)
dfs4 <- compensation_inter_UE(dfs4, ue_scientifique = c(lesUE[1], lesUE[2]))
LesUE <- bind_rows(dfs3, dfs4)
ligne_unique_totale_s3[[i]] <- creer_ligne_unique_s3(dfs3)
ligne_unique_totale_s4[[i]] <- creer_ligne_unique_s4(dfs4)
}
ligne_unique_totale_s3 <- bind_rows(ligne_unique_totale_s3)
ligne_unique_totale_s4 <- bind_rows(ligne_unique_totale_s4)
write_data_to_sheet("/home/nguyen-anh-dung/jury.xlsx", "S3", ligne_unique_totale_s3)
write_data_to_sheet("/home/nguyen-anh-dung/jury.xlsx", "S4", ligne_unique_totale_s4)
}
main()
source("Code/cste/Constantes_MCC.R")
source("Code/generation_notes/compensation.R")
source("Code/generation_notes/generer_notes_automatique.R")
source("Code/generation_notes/creer_ligne_unique.R")
source("Code/generation_notes/write_data_to_sheet.R")
library(dplyr)
main <- function() {
ligne_unique_totale_s3 <- list()
ligne_unique_totale_s4 <- list()
for (i in 1:25){
resultat_FONDA_S3 <- generer_notes_automatique(lesUE[1], lesEC_FONDAS3, lesNotesEC_FONDAS3, poids_FONDA_S3, lesECTSFONDAS3)
resultat_FONDA_S4 <- generer_notes_automatique(lesUE[1], lesEC_FONDAS4, lesNotesEC_FONDAS4, poids_FONDA_S4, lesECTSFONDAS4)
resultat_EXP_S3 <- generer_notes_automatique(lesUE[2], lesEC_EXPS3, lesNotesEC_EXPS3, poids_EXP_S3, lesECTSEXPS3)
resultat_EXP_S4 <- generer_notes_automatique(lesUE[2], lesEC_EXPS4, lesNotesEC_EXPS4, poids_EXP_S4, lesECTSEXPS4)
resultat_ORT_S3 <- generer_notes_automatique(lesUE[3], lesEC_ORTS3, lesNotesEC_ORTS3, poids_ORT_S3, lesECTSORTS3)
resultat_ORT_S4 <- generer_notes_automatique(lesUE[3], lesEC_ORTS4, lesNotesEC_ORTS4, poids_ORT_S4, lesECTSORTS4)
resultat_HUMA_S3 <- generer_notes_automatique(lesUE[4], lesEC_HUMA_S3, lesNotesEC_HUMA, poids_HUMA_S3, lesECTSHUMAS3)
resultat_HUMA_S4 <- generer_notes_automatique(lesUE[4], lesEC_HUMA_S4, lesNotesEC_HUMA, poids_HUMA_S4, lesECTSHUMAS4)
resultat_STAG_S3 <- generer_notes_automatique(lesUE[5], lesEC_Stage, lesNotesEC_Stage, poids_STAG_S3, lesECTSStage)
dfs3 <- bind_rows(resultat_FONDA_S3, resultat_EXP_S3, resultat_ORT_S3, resultat_HUMA_S3)
dfs3 <- compensation_intra_UE(dfs3)
dfs3 <- compensation_inter_UE(dfs3, ue_scientifique = c(lesUE[1], lesUE[2]))
dfs4 <- bind_rows(resultat_FONDA_S4, resultat_EXP_S4, resultat_ORT_S4, resultat_HUMA_S4)
dfs4 <- compensation_intra_UE(dfs4)
dfs4 <- compensation_inter_UE(dfs4, ue_scientifique = c(lesUE[1], lesUE[2]))
LesUE <- bind_rows(dfs3, dfs4)
ligne_unique_totale_s3[[i]] <- creer_ligne_unique_s3(dfs3)
ligne_unique_totale_s4[[i]] <- creer_ligne_unique_s4(dfs4)
}
ligne_unique_totale_s3 <- bind_rows(ligne_unique_totale_s3)
ligne_unique_totale_s4 <- bind_rows(ligne_unique_totale_s4)
write_data_to_sheet("/home/nguyen-anh-dung/jury.xlsx", "S3", ligne_unique_totale_s3)
write_data_to_sheet("/home/nguyen-anh-dung/jury.xlsx", "S4", ligne_unique_totale_s4)
}
main()
source("Code/cste/Constantes_MCC.R")
source("Code/generation_notes/compensation.R")
source("Code/generation_notes/generer_notes_automatique.R")
source("Code/generation_notes/creer_ligne_unique.R")
source("Code/generation_notes/write_data_to_sheet.R")
library(dplyr)
source("Code/cste/Constantes_MCC.R")
source("Code/generation_notes/compensation.R")
source("Code/generation_notes/generer_notes_automatique.R")
source("Code/generation_notes/creer_ligne_unique.R")
source("Code/generation_notes/write_data_to_sheet.R")
library(dplyr)
main <- function() {
ligne_unique_totale_s3 <- list()
ligne_unique_totale_s4 <- list()
for (i in 1:25){
resultat_FONDA_S3 <- generer_notes_automatique(lesUE[1], lesEC_FONDAS3, lesNotesEC_FONDAS3, poids_FONDA_S3, lesECTSFONDAS3)
resultat_FONDA_S4 <- generer_notes_automatique(lesUE[1], lesEC_FONDAS4, lesNotesEC_FONDAS4, poids_FONDA_S4, lesECTSFONDAS4)
resultat_EXP_S3 <- generer_notes_automatique(lesUE[2], lesEC_EXPS3, lesNotesEC_EXPS3, poids_EXP_S3, lesECTSEXPS3)
resultat_EXP_S4 <- generer_notes_automatique(lesUE[2], lesEC_EXPS4, lesNotesEC_EXPS4, poids_EXP_S4, lesECTSEXPS4)
resultat_ORT_S3 <- generer_notes_automatique(lesUE[3], lesEC_ORTS3, lesNotesEC_ORTS3, poids_ORT_S3, lesECTSORTS3)
resultat_ORT_S4 <- generer_notes_automatique(lesUE[3], lesEC_ORTS4, lesNotesEC_ORTS4, poids_ORT_S4, lesECTSORTS4)
resultat_HUMA_S3 <- generer_notes_automatique(lesUE[4], lesEC_HUMA_S3, lesNotesEC_HUMA, poids_HUMA_S3, lesECTSHUMAS3)
resultat_HUMA_S4 <- generer_notes_automatique(lesUE[4], lesEC_HUMA_S4, lesNotesEC_HUMA, poids_HUMA_S4, lesECTSHUMAS4)
resultat_STAG_S3 <- generer_notes_automatique(lesUE[5], lesEC_Stage, lesNotesEC_Stage, poids_STAG_S3, lesECTSStage)
dfs3 <- bind_rows(resultat_FONDA_S3, resultat_EXP_S3, resultat_ORT_S3, resultat_HUMA_S3)
dfs3 <- compensation_intra_UE(dfs3, UE = c(lesUE[1], lesUE[2], lesUE[3], lesUE[4], lesUE[5]))
dfs3 <- compensation_inter_UE(dfs3, ue_scientifique = c(lesUE[1], lesUE[2]))
dfs4 <- bind_rows(resultat_FONDA_S4, resultat_EXP_S4, resultat_ORT_S4, resultat_HUMA_S4)
dfs4 <- compensation_intra_UE(dfs4)
dfs4 <- compensation_inter_UE(dfs4, ue_scientifique = c(lesUE[1], lesUE[2]))
LesUE <- bind_rows(dfs3, dfs4)
ligne_unique_totale_s3[[i]] <- creer_ligne_unique_s3(dfs3)
ligne_unique_totale_s4[[i]] <- creer_ligne_unique_s4(dfs4)
}
ligne_unique_totale_s3 <- bind_rows(ligne_unique_totale_s3)
ligne_unique_totale_s4 <- bind_rows(ligne_unique_totale_s4)
write_data_to_sheet("/home/nguyen-anh-dung/jury.xlsx", "S3", ligne_unique_totale_s3)
write_data_to_sheet("/home/nguyen-anh-dung/jury.xlsx", "S4", ligne_unique_totale_s4)
}
main()
library(dplyr)
lesUE<-c("FONDA","EXP","ORT","HUMA","OPT")
tableau_lesUE<-data.frame(ListDeUE=lesUE)
# -----------------   génération des notes automatiques ----------------
generer_notes_automatique <- function(UE, EC, evaluations, poids_evaluation, ects) {
result_list <- list()
for (i in seq_along(EC)) {
eval_dispo <- evaluations[[EC[i]]]
poids_dispo <- poids_evaluation[[EC[i]]]
eval_dispo <- eval_dispo[!is.na(eval_dispo)]
poids_dispo <- poids_dispo[!is.na(poids_dispo)]
if (length(eval_dispo) > 0){
notes <- sapply(eval_dispo, function(x) sample(0:20, 1))
moyenne <- sum(notes * poids_dispo) / sum(poids_dispo)
validation <- ifelse(moyenne >= 10, "Valide", "Non valide")
df_temp <- data.frame(
UE = UE,
EC = EC[i],
Moyenne = signif(moyenne, 4),
ECTS = ects[i],
Validation = validation
)
df_temp <- cbind(df_temp, t(notes))
} else {
df_temp <- data.frame(
UE = UE,
EC = EC[i],
Moyenne = NA,
ECTS = ects[i],
Validation = "Non évalué"
)
}
result_list[[i]] <- df_temp
}
df_final <- bind_rows(result_list)
return (df_final)
}
compensation_intra_UE <- function(df){
df <- df %>%
group_by(UE) %>%
mutate(
Moyenne_UE = signif((sum(Moyenne * ECTS, na.rm = TRUE) / sum(ECTS[!is.na(Moyenne)], na.rm = TRUE)), 4),
Validation = ifelse(Moyenne_UE >= 10 & Validation == "Non valide", "ValideComp", Validation)
) %>%
ungroup()
return (df)
}
compensation_inter_UE <- function(df, ue_scientifique){
df_scientifique <- df %>% filter(UE %in% ue_scientifique)
moyenne_ponderee_ue <- df_scientifique %>%
group_by(UE) %>%
summarise(
Moyenne_UE = mean(Moyenne, na.rm = TRUE),
.groups = "drop"
) %>%
summarise(
Moyenne_globale = mean(Moyenne_UE, na.rm = TRUE)
) %>%
pull(Moyenne_globale)
if(moyenne_ponderee_ue >= 10){
df <- df %>%
mutate(
Validation = ifelse(UE %in% ue_scientifique & Validation == "Non valide", "ValideComp", Validation)
)
}
return (df)
}
# Calculer les données synthétiques pour chaque UE
creer_ligne_unique <- function(df) {
# Fonction utilitaire pour extraire les données pour une UE spécifique
extraire_donnees <- function(df, ue_name, ecs) {
sous_df <- df %>% filter(UE == ue_name)
validation_ue <- unique(sous_df$Validation)
somme_ects <- sum(sous_df$ECTS, na.rm = TRUE)
moyenne_ue <- unique(sous_df$Moyenne_UE)
validation_ue <- ifelse(moyenne_ue >= 10, "Valide", "Non valide")
moyennes_ec <- sapply(ecs, function(ec) {
moyenne_ec <- sous_df %>% filter(EC == ec) %>% pull(Moyenne)
if (length(moyenne_ec) == 0) return(NA) else return(moyenne_ec)
})
return(c(validation_ue, somme_ects, moyenne_ue, moyennes_ec))
}
# Créer la ligne unique avec les données demandées
ligne <- c(
extraire_donnees(df, "EXP S3", c("ACSA", "CHIM", "ELEC", "PHYS", "THEN")),
extraire_donnees(df, "FONDA S3", c("ALG", "ANA", "INFO", "MECA")),
extraire_donnees(df, "ORT S3", c("ADS", "PPI", "RIE", "STAG", "TSE")),
extraire_donnees(df, "HUMA S3", c("ANGL", "COMM", "EPS", "LV2"))
)
# Ajouter des noms de colonnes clairs
col_names <- c(
"Validation_EXP_S3", "Somme_ECTS_EXP_S3", "Moyenne_UE_EXP_S3", "Moyenne_ACSA", "Moyenne_CHIM",
"Moyenne_ELEC", "Moyenne_PHYS", "Moyenne_THEN",
"Validation_FONDA_S3", "Somme_ECTS_FONDA_S3", "Moyenne_UE_FONDA_S3", "Moyenne_ALG",
"Moyenne_ANA", "Moyenne_INFO", "Moyenne_MECA",
"Validation_ORT_S3", "Somme_ECTS_ORT_S3", "Moyenne_UE_ORT_S3", "Moyenne_ADS",
"Moyenne_PPI", "Moyenne_RIE", "Moyenne_STAG", "Moyenne_TSE",
"Validation_HUMA_S3", "Somme_ECTS_HUMA_S3", "Moyenne_UE_HUMA_S3", "Moyenne_ANGL",
"Moyenne_COMM", "Moyenne_EPS", "Moyenne_LV2"
)
# Transformer en DataFrame
ligne_df <- as.data.frame(t(ligne), stringsAsFactors = FALSE)
colnames(ligne_df) <- col_names
return(ligne_df)
}
# Appliquer la fonction pour créer le DataFrame final
ligne_unique <- creer_ligne_unique(dfs3)
print(ligne_unique)
